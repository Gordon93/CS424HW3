<!DOCTYPE html>


<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>Application</title>

<!-- Josh local test calls for local editing, do not remove unless you are Joshua --
        <link rel="stylesheet" type="text/css" href="/bootstrap-3.3.4-dist/css/bootstrap.min.css">
        <script type="text/javascript" src="D3/d3.js"></script>
        <script type="text/javascript" src="jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="leaflet.css" />
        <script type="text/javascript" src="leaflet.js"></script>

<!-- End Josh local test section. -->


		<!-- Core bootstrap CSS -->
        <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

        <!-- d3 library -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script> 

        <!-- Ajax -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

        <!--Angular-->
        <script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.11.2.js"></script>

        <!-- leaflet -->
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.css" />
        <script src="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.js"></script>

        <!-- jQuery -->
        <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
        <script src="//code.jquery.com/jquery-1.10.2.js"></script>
        <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
        <link rel="stylesheet" href="/resources/demos/style.css">

        <!-- Leaflet playback -->
        <script src="LeafletPlayback.js"></script>

        -->
		<!-- Custom styles for this template -->
		<link href="styles.css" rel="stylesheet">

        <script src="barChart.js"></script>

        <script src="bootstrap.js"></script>

        <script src="lib/common.js"></script>
        <script src="lib/echonest/echonest.js"></script>
        <script src="lib/artistforcegraph.js"></script>
        <script src="lib/artistdata.js"></script>


    </head>
	
	<body>
	        <!-- This section begins the bootstrap button headers -->
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container" style="margin-left:inherit">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Project 2</a>

                </div>
                <div id="navbar" class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="app.html">Application</a></li>
                        <li><a href="facts.html">Facts</a></li>
                        <li><a href="setup.html">Setup</a></li>
                        <li><a href="data.html">Data</a></li>
                        <li><a href="work.html">Work</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="pageContent">
            <!-- PUT ALL PAGE CODE EITHER IN OR BELOW THIS DIV! OTHERWISE IT WILL FALL BELOW THE NAV BAR! -->

            <script>

                $(document).ready(function(){

                    $('ul.tabs li').click(function(){
                        var tab_id = $(this).attr('data-tab');

                        $('ul.tabs li').removeClass('current');
                        $('.tab-content').removeClass('current');

                        $(this).addClass('current');
                        $("#"+tab_id).addClass('current');
                    })

                })
            </script>

            <div id="user1panel" class="inline" style="height:90vh; width:17vw;font-size:1vw;">
                <div id="user1info" style="height:40%;width:100%;">
                    <div style="width:50%;height:100%;" class="inline">
                        <h3 style="font-size:1vw;margin-top:8px;">Artists</h3>
                            <div id="user1_artistlist" style="width:100%;height:86%;overflow:auto;"></div>
                    </div>

                    <div style="width:50%;height:100%;" class="inline">
                        <h3 style="font-size:1vw;margin-top:8px;">Genres</h3>
                            <div id="user1_genrelist" style="width:100%;height:86%;overflow:auto;"></div>
                    </div>
                </div>
                <div id="user1interface" style="height:60%">
                    <ul class="tabs">
                        <li class="tab-link current" data-tab="user1_highlight">Selection</li>
                        <li class="tab-link" data-tab="user1_artists">Artists</li>
                        <li class="tab-link" data-tab="user1_genres">Genres</li>
                    </ul>

                    <div id="user1_highlight" style="height:100%;" class="tab-content current">
                        <input type="checkbox" id="user1_selection_checkbox_artist" value="artist">Artist:
                        <select id="user1_selection_artistlist" style="width:70%;"></select> <br/>
                        <input type="checkbox" id="user1_selection_checkbox_genre" value="artist">Genre:
                        <select id="user1_selection_genrelist" style="width:70%;">
                        </select><br/>
                        <input type="checkbox" id="user1_selection_checkbox_decade" value="artist">Decade:
                        <select id="user1_selection_decadelist" style="width:50%;">
                            <option value="1900">1900's</option>
                            <option value="1910">1910's</option>
                            <option value="1920">1920's</option>
                            <option value="1930">1930's</option>
                            <option value="1940">1940's</option>
                            <option value="1950">1950's</option>
                            <option value="1960">1960's</option>
                            <option value="1970">1970's</option>
                            <option value="1980">1980's</option>
                            <option value="1990">1990's</option>
                            <option value="2000">2000's</option>
                            <option value="2010">2010's</option>
                        </select><br/>
                        <button id="user1_selection_button" onclick="user1_highlight_selections()" style="width:8vw;height:4vh;font-size:.6vw">Highlight Selection</button>
                    </div>
                    <div id="user1_artists" style="height:90%;" class="tab-content">
                        <div class="inline" style="height:100%;width:30%;">
                            <select multiple id="user1_artist_artistlist"  style="height:80%;width:100%;overflow:auto;">
                            </select> <br/>
                            <button id="user1_artist_button_removeartist" onclick="user1_removeartist()" style="width:5vw;height:4vh;">Remove</button>
                        </div>
                        <div style="height:100%;width:40%;font-size:.8vw;" class="inline">
                            Name: <input type="text" style="width:50%" id="user1_artist_textbox_artistsearch"><br/>
                            Genre:
                            <select id="user1_artist_selection_genre" style="width:50%;overflow:auto;">
                            <option value=""></option>
                            </select> <br/>
                            Decade:<select id="user1_artist_selection_decade" style="width:35%;">
                            <option value=""></option>
                            <option value="1900">1900's</option>
                            <option value="1910">1910's</option>
                            <option value="1920">1920's</option>
                            <option value="1930">1930's</option>
                            <option value="1940">1940's</option>
                            <option value="1950">1950's</option>
                            <option value="1960">1960's</option>
                            <option value="1970">1970's</option>
                            <option value="1980">1980's</option>
                            <option value="1990">1990's</option>
                            <option value="2000">2000's</option>
                            <option value="2010">2010's</option>
                        </select> <br/>
                            <button id="user1_artist_button_searchartist" style="width:6vw;height:4vh;">Search</button> <br/>
                            <select multiple id="user1_artist_searchresults" style="height:40%;width:100%;overflow:auto;">
                            </select> <br/>
                            <!--<button id="user1_artist_button_addartist" onclick="user1_addartist()" style="width:5vw;height:4vh;">Add</button> <br/>-->
                        </div>
                        <div class="inline" style="height:100%; width:30%;">
                            Related Artists <br/>
                            <select multiple id="user1_artist_relatedartists" style="height:80%;width:95%;overflow:auto;">
                            </select> <br/>
                        </div>
                    </div>

                    <div id="user1_genres" style="height:90%;" class="tab-content">
                        <div class="inline" style="height:100%;width:40%;">
                            <select multiple id="user1_genre_genrelist" style="height:80%;width:100%;overflow:auto;">
                            </select> <br/>
                            <button id="user1_genre_button_removegenre" onclick="user1_removegenre()" style="width:6vw;height:4vh;">Remove</button>
                        </div>
                        <div style="height:100%;width:60%" class="inline">
                            Name: <input type="textbox" style="width:60%" id="user1_genre_artistsearch"><br/>
                            Decade:<select id="user1_genre_selection_decade" style="width:50%;">
                            <option value=""></option>
                            <option value="1900">1900's</option>
                            <option value="1910">1910's</option>
                            <option value="1920">1920's</option>
                            <option value="1930">1930's</option>
                            <option value="1940">1940's</option>
                            <option value="1950">1950's</option>
                            <option value="1960">1960's</option>
                            <option value="1970">1970's</option>
                            <option value="1980">1980's</option>
                            <option value="1990">1990's</option>
                            <option value="2000">2000's</option>
                            <option value="2010">2010's</option>
                        </select> <br/>
                            Sort: <select id="user1_genre_selection_sort" style="width:50%;">
                            <option value="alpha">Alphabetical</option>
                            <option value="hot">Hotness</option>

                        </select> <br/>
                            <button id="user1_genre_button_searchgenre" style="width:6vw;height:4vh;">Search</button> <br/>
                            <select multiple id="user1_genre_selection_genre" style="height:35%;width:95%;overflow:auto;">
                            </select> <br/>
                            <!--<button id="user1_genre_button_addgenre" style="width:5vw;height:4vh;">Add</button> <br/>-->
                        </div>
                    </div>
                </div>
            </div>

            <div id="shared" class="inline" style="height:90vh; width:64vw;">
                <div id="timeline" style="width:100%;height:30%;">
                    <div id="chartContainer" style="width:100%;height:100%;">
                        <div id="bar"></div>
                    </div>
                </div>
                <div id="map" class="inline" style="width:50%;height:70%">
                </div>
                <div id="fdg" class="inline" style="width:50%;height:70%">
                </div>
            </div>

            <div id="user2panel" class="inline" style="height:90vh; width:17vw;font-size:1vw;">
                <div id="user2info" style="height:40%;width:100%;">
                    <div style="width:50%;height:100%;" class="inline">
                        <h3 style="font-size:1vw;margin-top:8px;">Artists</h3>
                        <div id="user2_artistlist" style="width:100%;height:86%;overflow:auto;"></div>
                    </div>

                    <div style="width:50%;height:100%;" class="inline">
                        <h3 style="font-size:1vw;margin-top:8px;">Genres</h3>
                        <div id="user2_genrelist" style="width:100%;height:86%;overflow:auto;"></div>
                    </div>
                </div>
                <div id="user2interface" style="height:60%">
                    <ul class="tabs">
                        <li class="tab-link current" data-tab="user2_highlight">Selection</li>
                        <li class="tab-link" data-tab="user2_artists">Artists</li>
                        <li class="tab-link" data-tab="user2_genres">Genres</li>
                    </ul>

                    <div id="user2_highlight" style="height:100%;" class="tab-content current">
                        <input type="checkbox" id="user2_selection_checkbox_artist" value="artist">Artist:
                        <select id="user2_selection_artistlist" style="width:70%;"></select> <br/>
                        <input type="checkbox" id="user2_selection_checkbox_genre" value="artist">Genre:
                        <select id="user2_selection_genrelist" style="width:70%;">
                        </select><br/>
                        <input type="checkbox" id="user2_selection_checkbox_decade" value="artist">Decade:
                        <select id="user2_selection_decadelist" style="width:50%;">
                            <option value="1900">1900's</option>
                            <option value="1910">1910's</option>
                            <option value="1920">1920's</option>
                            <option value="1930">1930's</option>
                            <option value="1940">1940's</option>
                            <option value="1950">1950's</option>
                            <option value="1960">1960's</option>
                            <option value="1970">1970's</option>
                            <option value="1980">1980's</option>
                            <option value="1990">1990's</option>
                            <option value="2000">2000's</option>
                            <option value="2010">2010's</option>
                        </select><br/>
                        <button id="user2_selection_button" onclick="user2_highlight_selections()" style="width:8vw;height:4vh;font-size:.6vw">Highlight Selection</button>
                    </div>
                    <div id="user2_artists" style="height:90%;" class="tab-content">
                        <div class="inline" style="height:100%;width:30%;">
                            <select multiple id="user2_artist_artistlist"  style="height:80%;width:100%;overflow:auto;">
                            </select> <br/>
                            <button id="user2_artist_button_removeartist" onclick="user2_removeartist()" style="width:5vw;height:4vh;">Remove</button>
                        </div>
                        <div style="height:100%;width:40%;font-size:.8vw;" class="inline">
                            Name: <input type="text" style="width:50%" id="user2_artist_textbox_artistsearch"><br/>
                            Genre:
                            <select id="user2_artist_selection_genre" style="width:50%;overflow:auto;">
                                <option value=""></option>
                            </select> <br/>
                            Decade:<select id="user2_artist_selection_decade" style="width:35%;">
                            <option value=""></option>
                            <option value="1900">1900's</option>
                            <option value="1910">1910's</option>
                            <option value="1920">1920's</option>
                            <option value="1930">1930's</option>
                            <option value="1940">1940's</option>
                            <option value="1950">1950's</option>
                            <option value="1960">1960's</option>
                            <option value="1970">1970's</option>
                            <option value="1980">1980's</option>
                            <option value="1990">1990's</option>
                            <option value="2000">2000's</option>
                            <option value="2010">2010's</option>
                        </select> <br/>
                            <button id="user2_artist_button_searchartist" style="width:6vw;height:4vh;">Search</button> <br/>
                            <select multiple id="user2_artist_searchresults" style="height:40%;width:100%;overflow:auto;">
                            </select> <br/>
                            <!--<button id="user2_artist_button_addartist" onclick="user2_addartist()" style="width:5vw;height:4vh;">Add</button> <br/>-->
                        </div>
                        <div class="inline" style="height:100%; width:30%;">
                            Related Artists <br/>
                            <select multiple id="user2_artist_relatedartists" style="height:80%;width:95%;overflow:auto;">
                            </select> <br/>
                        </div>
                    </div>

                    <div id="user2_genres" style="height:90%;" class="tab-content">
                        <div class="inline" style="height:100%;width:40%;">
                            <select multiple id="user2_genre_genrelist" style="height:80%;width:100%;overflow:auto;">
                            </select> <br/>
                            <button id="user2_genre_button_removegenre" onclick="user2_removegenre()" style="width:6vw;height:4vh;">Remove</button>
                        </div>
                        <div style="height:100%;width:60%" class="inline">
                            Name: <input type="textbox" style="width:60%" id="user2_genre_artistsearch"><br/>
                            Decade:<select id="user2_genre_selection_decade" style="width:50%;">
                            <option value=""></option>
                            <option value="1900">1900's</option>
                            <option value="1910">1910's</option>
                            <option value="1920">1920's</option>
                            <option value="1930">1930's</option>
                            <option value="1940">1940's</option>
                            <option value="1950">1950's</option>
                            <option value="1960">1960's</option>
                            <option value="1970">1970's</option>
                            <option value="1980">1980's</option>
                            <option value="1990">1990's</option>
                            <option value="2000">2000's</option>
                            <option value="2010">2010's</option>
                        </select> <br/>
                            Sort: <select id="user2_genre_selection_sort" style="width:50%;">
                            <option value="alpha">Alphabetical</option>
                            <option value="hot">Hotness</option>

                        </select> <br/>
                            <button id="user2_genre_button_searchgenre" style="width:6vw;height:4vh;">Search</button> <br/>
                            <select multiple id="user2_genre_selection_genre" style="height:35%;width:95%;overflow:auto;">
                            </select> <br/>
                            <!--<button id="user2_genre_button_addgenre" style="width:5vw;height:4vh;">Add</button> <br/>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
            </div>
            </div>

            <!--map js code-->
            <script type="text/javascript">



                var map = L.map('map').setView([41.83, -100], 3);

                // creating a map

                L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
                    attribution: 'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://mapbox.com">Mapbox</a>',
                    maxZoom: 18,
                    noWrap: true,
                    id: 'ygordon22.cifd9ql4c53tbsmlx7cegx4iy',
                    accessToken: 'pk.eyJ1IjoieWdvcmRvbjIyIiwiYSI6ImNpZmQ5cW1idzUzeWFzNG03bjVqc3czZWEifQ.dpecRLb3F4lRAOvIVd5KpQ'
                }).addTo(map);

                var cities =[]
                var countries = []
                var decades = []
                var genres = []
                var names = []
                var marker = new Array();

                function getJson(){
                    $.getJSON( "data/top100.json", function( data ) {

                        //alert(JSON.stringify(data))
                        // now you can read the

                        for (var i=0; i<data.length; i++){
                            for (var j=0; j< data[i]["artists"].length;j++){

                                if(data[i]["artists"][j]["artist_location"] !=null){
                                    var mycity = data[i]["artists"][j]["artist_location"]["city"]
                                }
                                else{
                                    mycity = null;
                                }
                                cities.push(mycity)

                                if(data[i]["artists"][j]["artist_location"] !=null){

                                    if(data[i]["artists"][j]["artist_location"]["region"] !=null){
                                        mycountry = data[i]["artists"][j]["artist_location"]["region"]
                                    }
                                    else{
                                        var mycountry = data[i]["artists"][j]["artist_location"]["country"]
                                    }
                                }
                                else{
                                    mycountry = null;
                                }
                                countries.push(mycountry)


                                var myname = data[i]["artists"][j]["name"]
                                names.push(myname)

                                if(data[i]["artists"][j]["years_active"] !=null){
                                    var  myyear = data[i]["artists"][j]["years_active"][0]["start"]
                                }
                                else{
                                    var myyear = null;
                                }

                                decades.push(myyear)

                                if(data[i]["artists"][j]["genres"] != null){
                                    if(data[i]["artists"][j]["genres"][0] != null){
                                        var mygenre = data[i]["artists"][j]["genres"][0]["name"]
                                    }
                                }
                                else{
                                    var mygenre=null;
                                }
                                genres.push(mygenre)
                            }
                        }

                        names = names.slice(0,103)
                        cities = cities.slice(0,103)
                        decades = decades.slice(0,103)
                        countries = countries.slice(0,103)
                        genres = genres.slice(0,103)

                        GetResults();
                    });
                }


                function draw(location,i){

                    var lat = location["results"][0]["geometry"]["location"]["lat"];
                    var lng = location["results"][0]["geometry"]["location"]["lng"];
                    //alert([lat,lng])
                    //alert(names[i])
                    //var marker = L.marker([lat,lng]).addTo(map);
                    var mycolor = datautil.genreColor(genres[i])

                    var circle = L.circle([lat, lng], 30000
                    ,{
                    color: mycolor,
                    //fillColor: '#f03',
                    fillOpacity: 1
                    }).addTo(map);
                    
                    marker.push(circle);
                    //circle.setRadius=10000

                    var mylocation = "https://en.wikipedia.org/wiki/"+cities[i]
                    var myartist = "https://en.wikipedia.org/wiki/"+names[i]
                    //marker.bindPopup("<a href= '" + mylocation + "' >City</a>");
                    circle.bindPopup(names[i] + " belonged to " +genres[i]+ " is from " +cities[i]+" and started playing in "+decades[i] );
                    function onMapClick(e) {
                        e.openPopup();
                    }

                    map.on('click', onMapClick);
                }

                function GetResults() {
                    $.getJSON("locations.json", function( data ) {
                        //alert(JSON.stringify(data))
                        // alert(data.length)
                        for (var i=0; i<data.length; i++){
                            //alert(JSON.stringify(data[i]))
                            draw(data[i],i);
                        }
                    });
                    console.log(JSON.stringify(cities))
                    console.log(cities.length)
                    console.log(JSON.stringify(countries))
                    console.log(countries.length)
                    console.log(JSON.stringify(names))
                    console.log(names.length)
                    console.log(JSON.stringify(decades))
                    console.log(decades.length)
                }


                getJson();

                
                var points = 103;
                
                function add_node(artist){
                    // adding a new artist
                //cities.push(artist["artist_location"]["city"])
                cities.push(artist["location"]["city"])
                //countries.push(artist["artist_location"]["country"])
                countries.push(artist["location"]["country"])
                decades.push(artist["years_active"][0]["start"])
                genres.push(artist["genres"][0]["name"])
                names.push(artist["name"])
                
            $.getJSON("http://maps.google.com/maps/api/geocode/json?                     sensor=false&address="+cities[points], function(json) {
                        draw(json,points-1);
                        })
                    points++;
                }

                function removeNode(){
                    // removing a marker
                }
            </script>

            <!-- FDG-->
            <script>
                $(function() {
                    fdg.init("#fdg");
                });
            </script>
            <script>

                $(function () {
                    initSearchUI();
                    artistdata.init();
                    artistdata.artistsChanged.on(artistsChanged);
                });
                function initSearchUI() {
                    $("#user1_artist_button_searchartist").click(function() {
                        var search = $("#user1_artist_textbox_artistsearch").val();

                        function renderResults(r) {
                            d3.select("#user1_artist_searchresults").selectAll("option").remove();
                            r.forEach(function(d) {
                                d3.select("#user1_artist_searchresults")
                                        .append("option")
                                        .attr("value", d.id)
                                        .text(d.name)
                                        .on("dblclick", function () { user1_addArtist(d.id); });
                            });
                        }

                        artistdata.search(search, renderResults);
                    });
					$("#user2_artist_button_searchartist").click(function() {
                        var search = $("#user2_artist_textbox_artistsearch").val();

                        function renderResults(r) {
                            d3.select("#user2_artist_searchresults").selectAll("option").remove();
                            r.forEach(function(d) {
                                d3.select("#user2_artist_searchresults")
                                        .append("option")
                                        .attr("value", d.id)
                                        .text(d.name)
                                        .on("dblclick", function () { user2_addArtist(d.id); });
                            });
                        }

                        artistdata.search(search, renderResults);
                    });
					}

                var userList = [];
				var userList2 = [];

                function user1_addArtist(id) {
                    for (var i in d3.range(userList.length))
                        if (userList[i].id === id)
                            return;

                    artistdata.fetchArtist(id, function (a) {
                        userList.push(a);
                        artistdata.addArtist(a);


                        renderUserList();
                        user1_updateRecommended();

                        add_node(a)
                        function renderUserList() {
                            var options = d3.select("#user1_artistlist")
                                    .selectAll("option")
                                    .data(userList, function(d) { return d.id; });

                            options.enter()
                                    .append("option")
                                    .text(function (d) { return d.name; })

                            options.exit()
                                    .remove();

                            var options2 = d3.select("#user1_artist_artistlist")
                                    .selectAll("option")
                                    .data(userList, function(d) { return d.id; });

                            options2.enter()
                                    .append("option")
                                    .text(function (d) { return d.name; })

                            options2.exit()
                                    .remove();
                        }
                        fdg.graph.addNode(a);

                    });
                }

				function user2_addArtist(id) {
                    for (var i in d3.range(userList2.length))
                        if (userList2[i].id === id)
                            return;
				artistdata.fetchArtist(id, function (a) {
                        userList2.push(a);
                        artistdata.addArtist(a);


                        renderUserList();
                        user2_updateRecommended();

                    add_node(a)
                    function renderUserList() {
                        var options = d3.select("#user2_artistlist")
                                .selectAll("option")
                                .data(userList2, function(d) { return d.id; });

                        options.enter()
                                .append("option")
                                .text(function (d) { return d.name; })

                        options.exit()
                                .remove();

                        var options2 = d3.select("#user2_artist_artistlist")
                                .selectAll("option")
                                .data(userList2, function(d) { return d.id; });

                        options2.enter()
                                .append("option")
                                .text(function (d) { return d.name; })

                        options2.exit()
                                .remove();
                    }
                        fdg.graph.addNode(a);

                    });
                }
				
                function artistsChanged() {
                    renderArtistNames();
                    renderGenres();
                }

                function renderArtistNames() {
                    var data = artistdata.getArtists();
                    data.sort(function (a, b) {
                        return a.name.localeCompare(b.name);
                    });
                    var options = d3.select("#user1_selection_artistlist")
                            .selectAll("option")
                            .data(data, function (d) {
                                return d.id;
                            });

                    options.enter()
                            .append("option")
                            .text(function (d) {
                                return d.name;
                            });

                    options.exit()
                            .remove();
			var options = d3.select("#user2_selection_artistlist")
                            .selectAll("option")
                            .data(data, function (d) {
                                return d.id;
                            });

                    options.enter()
                            .append("option")
                            .text(function (d) {
                                return d.name;
                            });

                    options.exit()
                            .remove();
                }


                function renderGenres() {
                    var data = artistdata.getGenres();
                    data.sort();
                    var options = d3.select("#user1_selection_genrelist")
                            .selectAll("option")
                            .data(data, function (d) { return d; });

                    options.enter()
                            .append("option")
                            .property("value", function (d) { return d; })
                            .text(function (d) { return capitalizeWords(d); });

                    options.exit()
                            .remove();


                    var options = d3.select("#user1_artist_selection_genre")
                            .selectAll("option")
                            .data(data, function (d) { return d; });

                    options.enter()
                            .append("option")
                            .text(function (d) { return capitalizeWords(d); });

                    options.exit()
                            .remove();

                    var options = d3.select("#user1_genre_selection_genre")
                            .selectAll("option")
                            .data(data, function (d) { return d; });

                    options.enter()
                            .append("option")
                            .text(function (d) { return capitalizeWords(d); });

                    options.exit()
                            .remove();
			var options = d3.select("#user2_selection_genrelist")
                            .selectAll("option")
                            .data(data, function (d) { return d; });

                    options.enter()
                            .append("option")
                            .property("value", function (d) { return d; })
                            .text(function (d) { return capitalizeWords(d); });

                    options.exit()
                            .remove();


                    var options = d3.select("#user2_artist_selection_genre")
                            .selectAll("option")
                            .data(data, function (d) { return d; });

                    options.enter()
                            .append("option")
                            .text(function (d) { return capitalizeWords(d); });

                    options.exit()
                            .remove();

                    var options = d3.select("#user2_genre_selection_genre")
                            .selectAll("option")
                            .data(data, function (d) { return d; });

                    options.enter()
                            .append("option")
                            .text(function (d) { return capitalizeWords(d); });

                    options.exit()
                            .remove();
                }
            </script>

            <!--add to list-->
            <script>
                /*function user1_addartist()
                 {
                 var selected = document.getElementById('user1_artist_searchresults');
                 var artist = selected.options[selected.selectedIndex].text;
                 //alert(artist);
                 var newartist = document.createElement('option');
                 newartist.text = artist;
                 var list1 = document.getElementById('user1_artistlist');
                 //alert(newartist.text);
                 list1.appendChild(newartist);
                 var newartist2 = document.createElement('option');
                 newartist2.text = artist;
                 var list2 = document.getElementById('user1_artist_artistlist');
                 list2.appendChild(newartist2);
                 }*/

                function user1_updateRecommended() {
                    var ids = userList.map(function (a) { return a.id; });
                    if (ids.length > 0)
                        echonest.Artist.similar(ids, renderRecommended);
                    else
                        renderRecommended([]);
                    function renderRecommended(data) {
                        var options = d3.select("#user1_artist_relatedartists")
                                .selectAll("option")
                                .data(data, function(d) { return d.id; });

                        options.enter()
                                .append("option")
                                .text(function (d) { return d.name; })

                        options.exit()
                                .remove();
                    }
                }

                function user2_updateRecommended() {
                    var ids = userList2.map(function (a) { return a.id; });
                    if (ids.length > 0)
                        echonest.Artist.similar(ids, renderRecommended);
                    else
                        renderRecommended([]);
                    function renderRecommended(data) {
                        var options = d3.select("#user2_artist_relatedartists")
                                .selectAll("option")
                                .data(data, function(d) { return d.id; });

                        options.enter()
                                .append("option")
                                .text(function (d) { return d.name; })

                        options.exit()
                                .remove();
                    }
                }

                function user1_removeartist()
                {
                    var i;
                    var selected = document.getElementById('user1_artist_artistlist');
                    var artist = selected.options[selected.selectedIndex].text;
                    for(i=0;;i++)
                    {
                        if(selected.options[i].text == artist)
                            break;
                    }
                    selected.removeChild(selected.options[i]);
                    var selected2 = document.getElementById('user1_artistlist');
                    selected2.removeChild(selected2.children[i]);
                    userList.splice(i,1);
                    user1_updateRecommended();
                }

			function user2_removeartist()
                {
                    var i;
                    var selected = document.getElementById('user2_artist_artistlist');
                    var artist = selected.options[selected.selectedIndex].text;
                    for(i=0;;i++)
                    {
                        if(selected.options[i].text == artist)
                            break;
                    }
                    selected.removeChild(selected.options[i]);
                    var selected2 = document.getElementById('user2_artistlist');
                    selected2.removeChild(selected2.children[i]);
                    userList2.splice(i,1);
                    user2_updateRecommended();
                }
                var genreList = [];
				var genreList2 = [];
                document.getElementById('user1_genre_selection_genre').ondblclick = function()
                {
                    var selected = document.getElementById('user1_genre_selection_genre');
                    var genre = selected.options[selected.selectedIndex].text;
                    var list1 = document.getElementById('user1_genre_genrelist');

                    var i;

                    for(i=0;;i++)
                    {
                        if(list1.options[i] == undefined)
                            break;
                        if(list1.options[i].text == genre)
                        {
                            return;
                        }
                    }

                    genreList.push(genre);
                    var newgenre = document.createElement('option');
                    newgenre.text = genre;
                    //alert(newartist.text);
                    list1.appendChild(newgenre);
                    var newgenre2 = document.createElement('option');
                    newgenre2.text = genre;
                    var list2 = document.getElementById('user1_genrelist');
                    list2.appendChild(newgenre2);

                }

		document.getElementById('user2_genre_selection_genre').ondblclick = function()
                {
                    var selected = document.getElementById('user2_genre_selection_genre');
                    var genre = selected.options[selected.selectedIndex].text;
                    var list1 = document.getElementById('user2_genre_genrelist');

                    var i;

                    for(i=0;;i++)
                    {
                        if(list1.options[i] == undefined)
                            break;
                        if(list1.options[i].text == genre)
                        {
                            return;
                        }
                    }

                    genreList2.push(genre);
                    var newgenre = document.createElement('option');
                    newgenre.text = genre;
                    //alert(newartist.text);
                    list1.appendChild(newgenre);
                    var newgenre2 = document.createElement('option');
                    newgenre2.text = genre;
                    var list2 = document.getElementById('user2_genrelist');
                    list2.appendChild(newgenre2);

                }
				
                function user1_removegenre()
                {
                    var i;
                    var selected = document.getElementById('user1_genre_genrelist');
                    var genre = selected.options[selected.selectedIndex].text;
                    for(i=0;;i++)
                    {
                        if(selected.options[i].text == genre)
                            break;
                    }
                    selected.removeChild(selected.options[i]);
                    var selected2 = document.getElementById('user1_genrelist');
                    selected2.removeChild(selected2.children[i]);
                    genreList.splice(i,1);
                }

				function user2_removegenre()
                {
                    var i;
                    var selected = document.getElementById('user2_genre_genrelist');
                    var genre = selected.options[selected.selectedIndex].text;
                    for(i=0;;i++)
                    {
                        if(selected.options[i].text == genre)
                            break;
                    }
                    selected.removeChild(selected.options[i]);
                    var selected2 = document.getElementById('user2_genrelist');
                    selected2.removeChild(selected2.children[i]);
                    genreList2.splice(i,1);
                }


                function user1_highlight_selections()
                {
                    var artist = document.getElementById('user1_selection_artistlist').options[document.getElementById('user1_selection_artistlist').selectedIndex].text;
                    var genre = document.getElementById('user1_selection_genrelist').value;
                    var decade = document.getElementById('user1_selection_decadelist').value;
                    var isartist= document.getElementById('user1_selection_checkbox_artist').checked;
                    var isgenre= document.getElementById('user1_selection_checkbox_genre').checked;
                    var isdecade= document.getElementById('user1_selection_checkbox_decade').checked;

                    var id = artistdata.getArtists().filter(function(a)
                    {
//                        debugger;
                        if(isartist)
                            if(a.name !== artist)
                            return false;
                        if(isgenre)
                            if(a.genre !== genre)
                                return false;
                        if(isdecade)
                            if(a.year-(a.year%10) !== +decade)
                                return false;

                        return true;
                    }).map(function (a) { return a.id; });
                    fdg.graph.highlight("user1",id);

                    var user = [];
                    var id = 1;
                    var bool = false;
                    if(isartist) {
                        bool = true;
                        user.push({id:id,bool:bool,artist:artist});
                        getGenre(user[0]);
                        user=[];
                           for( var i=0;i<names.length;i++){
                               if(names[i] == artist){
                                  // alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'green'})
                               }
                           }
                    }
                    else if(!isartist){
                        bool = false;
                        user.push({id:id,bool:bool,artist:artist});
                        getGenre(user[0]);
                        user = [];
                    }

                    if(isgenre) {
                        bool = true;
                        user.push({id:id,bool:bool,genre:genre});
                        console.log(user[0]);
                        genreUpdate(user[0]);
                        user = [];
                          for( var i=0;i<genres.length;i++){
                                console.log(genres[i]);
                                if(genres[i] == genre){
                                   console.log(names[i])
                                   //alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'green'})
                                }
                            }
                    }
                    else if(!isgenre){
                        bool = false;
                        user.push({id:id,bool:bool,genre:genre});
                        console.log(user[0]);
                        genreUpdate(user[0]);
                        user = [];

                    }
                    console.log(isdecade);
                    if(isdecade==true) {
                        bool = true;
                        decade = +decade;
                        user.push({id:id,bool:bool,decade:decade});
                        decadeUpdate(user[0]);
                        user = [];
                         for( var i=0;i<decades.length;i++){
                                console.log(decades[i]);
                                if(decades[i] >= decade  && decades[i] <=
                                  (decade+10)){
                                   console.log(names[i])
                                   //alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'green'})
                                }
                                if(decades[i] >= (decade -10)  && decades[i] <=
                                  (decade)){
                                   console.log(names[i])
                                   //alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'green'})
                                }
                                   
                            }
                    }
                    else if(isdecade==false){
                        bool = false;
                        decade = +decade;
                        user.push({id:id,bool:bool,decade:decade});
                        decadeUpdate(user[0])
                        user = [];
                    }

                    HLBar(top10Genres,graphs[0].bar);


                }
				 function user2_highlight_selections()
                {
                    var artist = document.getElementById('user2_selection_artistlist').options[document.getElementById('user2_selection_artistlist').selectedIndex].text;
                    var genre = document.getElementById('user2_selection_genrelist').value;
                    var decade = document.getElementById('user2_selection_decadelist').value;
                    var isartist= document.getElementById('user2_selection_checkbox_artist').checked;
                    var isgenre= document.getElementById('user2_selection_checkbox_genre').checked;
                    var isdecade= document.getElementById('user2_selection_checkbox_decade').checked;

                    var id = artistdata.getArtists().filter(function(a)
                    {
//                        debugger;
                        if(isartist)
                            if(a.name !== artist)
                                return false;
                        if(isgenre)
                            if(a.genre !== genre)
                                return false;
                        if(isdecade)
                            if(a.year-(a.year%10) !== +decade)
                                return false;

                        return true;
                    }).map(function (a) { return a.id; });
                    fdg.graph.highlight("user2",id);

                    var user = [];
                    var id = 2;
                    var bool = false;
                    if(isartist) {
                        bool = true;
                        user.push({id:id,bool:bool,artist:artist});
                        getGenre(user[0]);
                        user=[];
                         for( var i=0;i<names.length;i++){
                               if(names[i] == artist){
                                  // alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'red'})
                               }
                           }
                    }
                    else if(!isartist){
                        bool = false;
                        user.push({id:id,bool:bool,artist:artist});
                        getGenre(user[0]);
                        user = [];
                    }

                    if(isgenre) {
                        bool = true;
                        user.push({id:id,bool:bool,genre:genre});
                        console.log(user[0]);
                        genreUpdate(user[0]);
                        user = [];
                          for( var i=0;i<genres.length;i++){
                                console.log(genres[i]);
                                if(genres[i] == genre){
                                   console.log(names[i])
                                   //alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'red'})
                                }
                            }
                    }
                    else if(!isgenre){
                        bool = false;
                        user.push({id:id,bool:bool,genre:genre});
                        console.log(user[0]);
                        genreUpdate(user[0]);
                        user = [];

                    }
                    console.log(isdecade);
                    if(isdecade==true) {
                        bool = true;
                        decade = +decade;
                        user.push({id:id,bool:bool,decade:decade});
                        decadeUpdate(user[0]);
                        user = [];
                               for( var i=0;i<decades.length;i++){
                                console.log(decades[i]);
                                if(decades[i] >= decade  && decades[i] <=
                                  (decade+10)){
                                   console.log(names[i])
                                   //alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'red'})
                                }
                                if(decades[i] >= (decade -10)  && decades[i] <=
                                  (decade)){
                                   console.log(names[i])
                                   //alert(names[i])
                                   marker[i].setRadius(70000);
                                   marker[i].setStyle({color: 'red'})
                                }
                                   
                            }
                    }
                    else if(isdecade==false){
                        bool = false;
                        decade = +decade;
                        user.push({id:id,bool:bool,decade:decade});
                        decadeUpdate(user[0])
                        user = [];
                    }

                    HLBar(top10Genres,graphs[0].bar);
                }
            </script>

	</body>
</html>